# contest: Codeforces Round #595 (Div. 3), problem: (B2) Books Exchange (hard version), Accepted, #, Copy
# ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░ 
# ░░░░░░░▄▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▄░░░░░░
# ░░░░░░█░░▄▀▀▀▀▀▀▀▀▀▀▀▀▄░░█░░░░░
# ░░░░░░█░█░░▀░░░░░░░░▀░░█░█░░░░░
# ░░░░░░█░█░░░▀░░░░░░▀░░░█░█░░░░░
# ░░░░░░█░█░░░░▀░░░░▀░░░░█░█░░░░░
# ░░░░░░█░█▄░░░░▀░░▀░░░░▄█░█░░░░░
# ░░░░░░█░█░░░░░░██░░░░░░█░█░░░░░
# ░░░░░░█░▀░░░░░░░░░░░░░░▀░█░░░░░
# ░░░░░░█░░░░░░░░░░░░░░░░░░█░░░░░
# ░░░░░░█░░░░░░░░░░░░░░░░░░█░░░░░
# ░░░░░░▀░░░░░░░░░░░░░░░░░░▀░░░░░
# ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░
 
for q in range(int(input())):
	n = int(input())
	p=list(map(int,input().split()))
	ans=[0]*n
	for i in range(n):
		count=1
		x=p[i]-1
		arr=[x]
		if not ans[i]:
			while p[i]!=p[x]:
				x=p[x]-1
				count+=1
				arr.append(x)
			for i in arr:
				ans[i]=count
			ans[i]=count
	print(*ans,sep=' ')
